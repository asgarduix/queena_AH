<html lang="zh-Hant-TW">
<head>
<meta charset="utf-8">
<meta http-equiv="content-language" content="zh-Hant-TW">
<meta name="viewport"
	content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
<meta name="apple-mobile-web-app-capable" content="yes">
<title>中科自主智慧防災水情系統建置計畫</title>
<!-- <link rel="shortcut icon" href="../../layout/flood.png"> -->
<link href="../../layout/tw/css/style.css" rel="stylesheet">
<link href="../../layout/tw/css/font-awesome-min.css" rel="stylesheet">
<link href="../../layout/tw/css/width_narrow.css" rel="stylesheet"
	media="only screen and (max-width: 639px)">
<link href="../../layout/tw/css/width_wide.css" rel="stylesheet"
	media="only screen and (min-width: 640px) and (max-width: 1023px)">
<link href="../../layout/tw/css/width_desktop.css" rel="stylesheet"
	media="only screen and (min-width: 1024px)">
<script src="../../js/common.js"></script>
<script src="../../js/jquery-2.1.1.min.js"></script>
<script src="../../js/jquery-iifun.js"></script>
</head>
<body>
	<div class="loginWrap">
		<div>
			<!-- LOGO start-->
			<header class="loginHeader">
				<h1>
					<a class="logo" href="./login" title="中科自主智慧防災水情後台管理系統">
						中科自主智慧防災水情後台管理系統 </a> <a style="float: right; font-size: 20px"
						href="./login" title="登出"> <i class="far fa-sign-out"></i> <span>登出</span>
					</a>
				</h1>

				<div name="loginuser" id="loginuser"></div>
				<div>警戒通知-固定發布時間維護</div>
			</header>
			<!-- LOGO end-->

			<div class="flex">
				<!-- Menu區塊 start-->
				<div class="manage_box bd-sidebar menu box">

					<nav class="collapse bd-links" id="bd-docs-nav">
						<div class="bd-toc-item">
							<a class="bd-toc-link ">功能清單</a>
						</div>
						<div class="bd-toc-item">
							<a class="bd-toc-link ">---------------</a>
						</div>
							<div class="bd-toc-item">
							<a class="bd-toc-link" href="/dpsbackendweb/usermanage">
								使用者維護 </a>
						</div>
							<div class="bd-toc-item">
							<a class="bd-toc-link" href="/dpsbackendweb/errorsendtime">
								警戒通知時間</a>
						</div>
							<div class="bd-toc-item">
							<a class="bd-toc-link" href="/dpsbackendweb/errorsendmail">
								警戒通知郵件</a>
						</div>
					</nav>

				</div>
				<!-- Menu區塊 end-->
				<!-- 內容區塊 start-->
				<main class="col" role="main">

				<div class="manage_box col">
					<div class="col FormElmt">
						<ul>
							<li><span class="label">發布時間</span></li>
							<li><span> <select id="schedule" name="schedule">
										<option value="0000">0000</option>
										<option value="0030">0030</option>
										<option value="0100">0100</option>
										<option value="0130">0130</option>
										<option value="0200">0200</option>
										<option value="0230">0230</option>
										<option value="0300">0300</option>
										<option value="0330">0330</option>
										<option value="0400">0400</option>
										<option value="0430">0430</option>
										<option value="0500">0500</option>
										<option value="0530">0530</option>
										<option value="0600">0600</option>
										<option value="0630">0630</option>
										<option value="0700">0700</option>
										<option value="0730">0730</option>
										<option value="0800">0800</option>
										<option value="0830">0830</option>
										<option value="0900">0900</option>
										<option value="0930">0930</option>
										<option value="1000">1000</option>
										<option value="1030">1030</option>
										<option value="1100">1100</option>
										<option value="1130">1130</option>
										<option value="1200">1200</option>
										<option value="1230">1230</option>
										<option value="1300">1300</option>
										<option value="1330">1330</option>
										<option value="1400">1400</option>
										<option value="1430">1430</option>
										<option value="1500">1500</option>
										<option value="1530">1530</option>
										<option value="1600">1600</option>
										<option value="1630">1630</option>
										<option value="1700">1700</option>
										<option value="1730">1730</option>
										<option value="1800">1800</option>
										<option value="1830">1830</option>
										<option value="1900">1900</option>
										<option value="1930">1930</option>
										<option value="2000">2000</option>
										<option value="2030">2030</option>
										<option value="2100">2100</option>
										<option value="2130">2130</option>
										<option value="2200">2200</option>
										<option value="2230">2230</option>
										<option value="2300">2300</option>
										<option value="2330">2330</option>
								</select>
							</span></li>

							<li><span class="label">啟用狀態</span></li>
							<li><span> <select id="status" name="status">
										<option value="1">啟用</option>
										<option value="2">停用</option>
								</select>
							</span></li>

						</ul>
						<div class="BtnLogin">
							<button id="edit" name="edit" class="btn btn-default"
								onclick="usermanageedit();return false;">修改</button>
						</div>
						<div class="BtnLogin">
							<button id="ret" name="ret" class="btn btn-default"
								onclick="usermanagelist();return false;">返回</button>
						</div>
					</div>
				</div>
				</main>
				<!-- 內容區塊 end-->
			</div>
			<!-- 圖片區塊 start-->
			<div class="imgLogin_box">
				<span class="img"> <a> <img
						src="../../layout/img_logo1.png" alt="">
				</a>
				</span> <span class="img"> <a> <img
						src="../../layout/img_logo2.png" alt="">
				</a>
				</span> <span class="img"> <a> <img
						src="../../layout/img_logo3.png" alt="">
				</a>
				</span>
			</div>
			<!-- 圖片區塊 end-->

		</div>
	</div>
	<!--Wrap end========-->
	<script type="text/javascript">
		$(function() {

			var loginuser = localStorage.getItem("loginuser")
			$("#loginuser").html("登入者:" + loginuser);

			var varid = localStorage.getItem("id");
			var varschedule = localStorage.getItem("schedule");
			var varstatus = localStorage.getItem("status");
 
			if (varid != null) {
				$("#schedule").val(varschedule);
				$("#status").val(varstatus);

			} else {
				var el = document.getElementById("edit");
				el.firstChild.data = "新增";
 
			}

		});

		function usermanagelist() {

			window.location = "./errorsendtime";
		}

		function usermanageedit() {

			var varcd = localStorage.getItem("createdate");
			var varcu = localStorage.getItem("createusr");
			var k = localStorage.getItem("token");
			var varschedule = $("#schedule").val();
			var varstatus = $("#status").val();
			var varid = localStorage.getItem("id");
			
			$("#id").val(varid);
			if (varid != null) {
				$.ajax({
					url : "http://localhost:10122/Schedule/time/edit",
					type : "POST",

					dataType : "json",
					data : {
						id : localStorage.getItem("id"),
						schedule : varschedule,
						status : varstatus,
						createdate : varcd,
						createusr : varcu,
						token : k
					},
					success : function(data) {
						// 這邊使用非同步，故需要在success中處理頁面資料
						console.log(data);
						alert("修改完成");
						location.href = "./errorsendtime";
					},
					error : function(data) {
						console.log(data);
						alert("修改失敗" + data);
					}
				});
			} else {
				$.ajax({
					url : "http://localhost:10122/Schedule/time/add",
					type : "POST",

					dataType : "json",
					data : {
// 						id : localStorage.getItem("id"),
						schedule : varschedule,
						status : varstatus,
						token : k
					},
					success : function(data) {
						// 這邊使用非同步，故需要在success中處理頁面資料
						console.log(data);

						alert(data.token);
						location.href = "./errorsendtime";
					},
					error : function(data) {
						console.log(data);
						alert("新增失敗" + data);
					}
				});
			}
		}
	</script>
	<style type="text/css">
.flex {
	display: flex;
}

.menu {
	width: 12%;
	background-color: white;
}

.col {
	width: 100%;
}

.bd-sidebar {
	order: 0; //
	background-color: #f5f2f9;
	border-bottom: 1px solid rgba(0, 0, 0, .1); @ include
	media-breakpoint-up(md) { @supports (position : sticky) {
      position : sticky;
	top: 4rem;
	z-index: 1000;
	height: calc(100vh - 4rem);
}
</style>
</body>
</html>